{% extends "layout.html.jinja" %}
{% block title %} Edit Playlist {% endblock %}
{% block page_title %}
<h1>
    {# {% playlistDetails.playlistName %} #}
    Playlist Name
</h1>
{% endblock %}
{% block content %}
{% if user_session != None %}
<div class="pure-g horizontal-double-content" style="padding: 2em;">
    <div class="pure-u-5-12">
        <div class="pure-form pure-u-1">
            <input type="text" class="pure-input-rounded" placeholder="Find a Song..." id="songSearch" />
            <button type="submit" class="pure-button" onclick="searchForSong()">Search</button>
        </div>
        <div class="songlst">
            {% for song in songs %}
            {% include "addsongcard.html.jinja" ignore missing with context %}
            {% endfor %}
        </div>

    </div>
    <div class="pure-u-5-12 horizontal-double-content">
        <div class="pure-g song-feild">
            <div class="pure-u-1-5 small-playlist-icon">
                <img src="playlist_image.jpg" alt="Playlist Image">

            </div>
            <div class="pure-u-1-3">
                <form class="pure-form pure-u-1" method="POST" action="/library">
                    <input type="text" placeholder="name of playlist" value="Name of playlist" />


            </div>
        </div>
        <div class="songlst">
            {% for song in songs %}
            {% include "deletesongcard.html.jinja" ignore missing with context %}
            {% endfor %}
        </div>
        <div class="right-align">
            <button onclick="saveChanges()" class="save-button pure-button">Save Changes</button>
        </div>
    </div>

</div>
</div>
{% else %}
<p> You can't access this page with out loging in</p>
<a href="/login" class="pure-menu-link">Log in</a>
{% endif %}


<script>
    var playlistSongIDs = [];
    var songs = "{{ songs }}";  // convert json?
    var playlistDetails = "{{ playlistDetails }}";
    /* songs.forEach(function (name, image, id){
        playlistSongIDs.push(id);
    }); */

    function searchForSong() {
        const searchQuery = document.getElementById("songSearch").value;
        const fetchURL = `/spotify/search?q=${encodeURIComponent(searchQuery)}`;
        console.log(fetchURL);
        fetch(fetchURL, {
            method: 'GET', // Ensure method is specified as 'GET'
            headers: {
                'Content-Type': 'application/json'
            }
        })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(searchRes => {
                console.log(searchRes);
                // Do something with the search results
                searchRes.forEach(function (searchedSong) {
                    console.log(searchedSong);
                });
            })
            .catch(error => {
                console.error('Error fetching data:', error);
            });
    }

    function addSong(elem) {

    }
    function removeSong(elem) {

    }
    function saveChanges() {

    }
</script>
{% endblock %}